{% extends 'admin/base.html' %}
{% block title %}Supplier Report - Admin{% endblock %}

{% block content %}


<div class="container mt-4">
    <div class="d-flex justify-content-between align-items-center mb-3">
        <h1>Supplier Report</h1>
        <form method="get" class="d-flex">
            <select name="supplier" class="form-select me-2">
                <option value="">All Suppliers</option>
                {% for sup in suppliers %}
                    <option value="{{ sup.id }}" {% if selected_supplier == sup.id %}selected{% endif %}>
                        {{ sup.name }}
                    </option>
                {% endfor %}
            </select>
            <button class="btn btn-primary">Filter</button>
        </form>
    </div>

    <table id="supplierTable" class="table table-striped table-bordered">
        <thead class="table-dark">
            <tr>
                <th>ID</th>
                <th>Medicine Name</th>
              
                <th>Price</th>
                <th>Stock Qty</th>
                <th>MFG Date</th>
                <th>EXP Date</th>
                <th>Supplier</th>
            </tr>
        </thead>
        <tbody>
            {% for med in medicines %}
            <tr>
                <td>{{ med.medicine_id }}</td>
                <td>{{ med.name }}</td>
               
                <td>{{ med.price }}</td>
                <td>
                    {% if med.stock_qty <= 0 %}
                        <span class="badge bg-danger">Out of Stock</span>
                    {% else %}
                        {{ med.stock_qty }}
                    {% endif %}
                </td>
                <td>{{ med.mfg_date }}</td>
                <td>
                    {% if med.exp_date < today %}
                        <span class="badge bg-warning text-dark">Expired</span>
                    {% else %}
                        {{ med.exp_date }}
                    {% endif %}
                </td>
                <td>{{ med.supplier.name }}</td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="9" class="text-center">No data available.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<!-- Scripts -->
<script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
<script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap5.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.4.1/js/dataTables.buttons.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.4.1/js/buttons.bootstrap5.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/pdfmake.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/vfs_fonts.js"></script>
<script src="https://cdn.datatables.net/buttons/2.4.1/js/buttons.html5.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.4.1/js/buttons.print.min.js"></script>

<script>
    $(document).ready(function () {
        $('#supplierTable').DataTable({
            dom: 'Bfrtip',
            buttons: [
                'copy', 'excel', 'pdf', 'print'
            ]
        });
    });
</script>
{% endblock %}
