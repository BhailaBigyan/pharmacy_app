{% extends "base.html" %}
{% block content %}
<div class="container mt-4">
  <h2 class="mb-3">Expired Medicines</h2>

  <div class="mb-3">
    <button onclick="printTable()" class="btn">Print</button>
  </div>

  <div id="expired-table">
    <table class="table table-bordered table-striped table-hover" style="font-size: 12px;">
      <thead class="table-dark">
        <tr>
          <th>Name</th>
          <th>Description</th>
          <th>Company</th>
          <th>Price</th>
          <th>Stock</th>
          <th>Mfg Date</th>
          <th>Exp Date</th>
          <th>Supplier</th>
        </tr>
      </thead>
      <tbody>
        {% for med in expired_list %}
        <tr>
          <td>{{ med.name }}</td>
          <td>{{ med.description|truncatewords:10 }}</td>
          <td>{{ med.company }}</td>
          <td>{{ med.price }}</td>
          <td>{{ med.stock_qty }}</td>
          <td>{{ med.mfg_date }}</td>
          <td><span class="badge bg-danger">Expired</span> {{ med.exp_date }}</td>
          <td>{{ med.supplier }}</td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="8" class="text-center">No expired medicines</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>

<script>
function printTable() {
  var divContents = document.getElementById("expired-table").innerHTML;
  var printWindow = window.open("", "", "height=600,width=900");
  printWindow.document.write("<html><head><title>Expired Medicines</title>");
  printWindow.document.write('<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">');
  printWindow.document.write("</head><body>");
  printWindow.document.write("<h2 class='text-center mb-3'>⚠️ Expired Medicines</h2>");
  printWindow.document.write(divContents);
  printWindow.document.write("</body></html>");
  printWindow.document.close();
  printWindow.print();
}
</script>
{% endblock %}
