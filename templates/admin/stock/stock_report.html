{% extends "admin/base.html" %}
{% block content %}
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
<!-- DataTables CSS -->
<link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/dataTables.bootstrap5.min.css">
<link rel="stylesheet" href="https://cdn.datatables.net/buttons/2.4.1/css/buttons.bootstrap5.min.css">

<div class="container mt-4">
    <div class="d-flex justify-content-between align-items-center mb-3">
        <h1>Stock Report</h1>
    </div>

    <table id="stockTable" class="table table-striped table-bordered">
        <thead class="table-dark">
            <tr>
                <th>ID</th>
                <th>Name</th>
                <th>Brand Name</th>
                <th>Category</th>
                <th>Price</th>
                <th>Stock Qty</th>
                <th>Mfg Date</th>
                <th>Exp Date</th>
                <th>Supplier</th>
            </tr>
        </thead>
        <tbody>
            {% for med in medicines %}
            <tr>
                <td>{{ med.medicine_id }}</td>
                <td>{{ med.name }}</td>
                <td>{{ med.brand_name }}</td>
                <td>{{ med.get_category_display }}</td>
                <td>{{ med.price }}</td>
                <td>
                    {% if med.stock_qty <= 0 %}
                        <span class="badge bg-danger">Out of Stock</span>
                    {% else %}
                        {{ med.stock_qty }}
                    {% endif %}
                </td>
                <td>{{ med.mfg_date }}</td>
                <td>
                    {% if med.exp_date < today %}
                        <span class="badge bg-warning text-dark">Expired</span>
                    {% else %}
                        {{ med.exp_date }}
                    {% endif %}
                </td>
                <td>{{ med.supplier.name }}</td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="9" class="text-center">No stock data available.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<!-- Scripts -->
<script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
<script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap5.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.4.1/js/dataTables.buttons.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.4.1/js/buttons.bootstrap5.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/pdfmake.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/vfs_fonts.js"></script>
<script src="https://cdn.datatables.net/buttons/2.4.1/js/buttons.html5.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.4.1/js/buttons.print.min.js"></script>

<script>
    $(document).ready(function () {
        $('#stockTable').DataTable({
            dom: 'Bfrtip',
            buttons: [
                'copy', 'excel', 'pdf', 'print'
            ]
        });
    });
</script>
{% endblock %}
